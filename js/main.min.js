window.addEventListener("load",(()=>{chrome.storage.sync.get((e=>{document.querySelector("#token").value=e.token,document.querySelector("#domainkey").value=e.domainkey,fetch("https://"+document.querySelector("#domainkey").value+".timev2.de/api/v1/clients",{method:"GET",headers:{"Content-Type":"application/json",authorization:document.querySelector("#token").value}}).then((e=>e.json())).then((e=>{for(let t=0;t<e.clients.length;t++){let o=document.createElement("option");o.innerText=e.clients[t].name,o.value=e.clients[t].id,document.querySelector("#clients").appendChild(o)}})),fetch("https://"+document.querySelector("#domainkey").value+".timev2.de/api/v1/projects",{method:"GET",headers:{"Content-Type":"application/json",authorization:document.querySelector("#token").value}}).then((e=>e.json())).then((e=>{for(let t=0;t<e.projects.length;t++){let o=document.createElement("option");o.innerText=e.projects[t].name,o.value=e.projects[t].id,document.querySelector("#projects").appendChild(o)}}))}))})),document.querySelector("#send").addEventListener("click",(()=>{let e=new XMLHttpRequest;e.open("POST","https://"+document.querySelector("#domainkey").value+".timev2.de/api/v1/times",!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("authorization",document.querySelector("#token").value),e.send(JSON.stringify({time:document.querySelector("#time").value,client:document.querySelector("#clients").value,project:document.querySelector("#projects").value,description:document.querySelector("#description").value})),e.onload=()=>{e.readyState===e.DONE&&(200===e.status?location.reload():document.querySelector("#error").classList.remove("d-none"))}})),document.querySelector("#edit").addEventListener("click",(()=>{document.querySelector("#form").classList.add("d-none"),document.querySelector("#settings").classList.toggle("d-none")})),document.querySelector("#cancel").addEventListener("click",(()=>{document.querySelector("#form").classList.toggle("d-none"),document.querySelector("#settings").classList.toggle("d-none")})),document.querySelector("#save").addEventListener("click",(()=>{chrome.storage.sync.set({domainkey:document.querySelector("#domainkey").value,token:document.querySelector("#token").value}),document.querySelector("#form").classList.toggle("d-none"),document.querySelector("#settings").classList.toggle("d-none")}));